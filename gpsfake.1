'\" t
.\"     Title: gpsfake
.\"    Author: [see the "AUTHOR" section]
.\" Generator: DocBook XSL Stylesheets v1.75.2 <http://docbook.sf.net/>
.\"      Date: 12 Feb 2005
.\"    Manual: GPSD Documentation
.\"    Source: The GPSD Project
.\"  Language: English
.\"
.TH "GPSFAKE" "1" "12 Feb 2005" "The GPSD Project" "GPSD Documentation"
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
gpsfake \- test harness for gpsd, simulating a GPS
.SH "SYNOPSIS"
.HP \w'\fBgpsfake\fR\ 'u
\fBgpsfake\fR [\-1] [\-h] [\-b] [\-c\ \fIinterval\fR] [\-i] [\-D\ \fIdebuglevel\fR] [\-l] [\-m\ \fImonitor\fR] [\-n] [\-o\ \fIoptions\fR] [\-p] [\-r\ \fIinitcmd\fR] [\-s\ \fIspeed\fR] [\-u] [\-v] [\fIlogfile\fR...]
.SH "DESCRIPTION"
.PP
gpsfake
is a test harness for
gpsd
and its clients\&. It opens a pty (pseudo\-TTY), launches a
gpsd
instance that thinks the slave side of the pty is its GPS device, and repeatedly feeds the contents of one or more test logfiles through the master side to the GPS\&. If there are multiple logfiles, sentences from them are interleaved in the order the fuiles are specified\&.
.PP
gpsfake
does not require root privileges, and can be run concurrently with a production
gpsd
instance without causing problems\&.
.PP
The logfiles may be of NMEA, SiRF packets, TSIP packets, or Zodiac packets\&. Leading lines beginning with # will be treated as comments and ignored\&.
.PP
The
gpsd
instance is run in foreground\&. The thread sending fake GPS data to the daemon is run in background\&.
.SH "OPTIONS"
.PP
With the \-1 option, the logfile is interpreted once only rather than repeatedly\&. This option is intended to facilitate regression testing\&.
.PP
The \-b option enables a twirling\-baton progress indicator on standard error\&. At termination, it reports elapsed time\&.
.PP
The \-c option sets the delay between sentences in seconds\&. Fractional values of seconds are legal\&. The default is zero (no delay)\&.
.PP
The \-l option makes the program dump a line or packet number just before each sentence is fed to the daemon\&. If the sentence is textual (e\&.g\&. NMEA), the text is dumped as well\&. If not, the packet will be dumped in hexadecimal (except for RTCM packets, which aren\*(Aqt dumped at all)\&. This option is useful for checking that gpsfake is getting packet boundaries right\&.
.PP
The \-i option is for single\-stepping through logfiles\&. It dumps the line or packet number (and the sentence if the protocol is textual) followed by "? "\&. Only when the user keys Enter is the line actually fed to
gpsd\&.
.PP
The \-m option specifies a monitor program inside which the daemon should be run\&. This option is intended to be used with
\fBvalgrind\fR(1),
\fBgdb\fR(1)
and similar programs\&.
.PP
The \-g option uses the monitor facility to run the
gpsd
instance within gpsfake under control of gdb\&.
.PP
The \-o option specifies options to pass to the daemon\&. The \-n option passes \-n to start the daemon reading the GPS without waiting for a client (equivalent to \-o "\-n")\&. The \-D option passes a \-D option to the daemon: thus \-D 4 is shorthand for \-o "\-D 4"\&.
.PP
The \-p ("pipe") option sets watcher mode and dumps the NMEA and GPSD notifications generated by the log to standard output\&. This is useful for regression\-testing\&.
.PP
The \-r option specifies an initialization command to use in pipe mode\&. The default is
\fB?WATCH={"enable":true,"json":true}\fR\&.
.PP
The \-s option sets the baud rate for the slave tty\&. The default is 4800\&.
.PP
The \-u option forces the test framework to use UDP rather than pty devices\&. This may be useful for testing from within chroot jails where access to pty devices is locked out\&.
.PP
The \-v option enables verbose progress reports to stderr\&. It is mainly useful for debugging
gpsfake
itself\&.
.PP
The \-x option dumps packets as
gpsfake
gathers them\&. It is mainly useful for debugging
gpsfake
itself\&.
.PP
The \-h option makes
gpsfake
print a usage message and exit\&.
.PP
The argument must be the name of a file containing the data to be cycled at the device\&.
gpsfake
will print a notification each time it cycles\&.
.PP
Normally, gpsfake creates a pty for each logfile and passes the slave side of the debice to the daemon\&. If the header comment in the logfile contains the string "UDP", packets are instead shipped via UDP port 5000 to the addess 192\&.168\&.0\&.1\&.255\&. You can monitoer them with this:
\fBtcpdump \-s0 \-n \-A \-i lo udp and port 5000\fR\&.
.SH "CUSTOM TESTS"
.PP
gpsfake
is a trivial wrapper around a Python module, also named gpsfake, that can be used to fully script sessions involving a
gpsd
instance, any number of client sessions, and any number of fake GPSes feeding the daemon instance with data from specified sentence logs\&.
.PP
Source and embedded documentation for this module is shipped with the
gpsd
development tools\&. You can use it to torture\-test either
gpsd
itself or any
gpsd\-aware client application\&.
.PP
Logfiles for the use with
gpsfake
can be retrieved using
gpspipe,
gpscat, or
gpsmon
from the gpsd distribution, or any other application which is able to create a compatible output\&.
.PP
If
gpsfake
exits with "Cannot execute gpsd: executable not found\&." the environment variable GPSD_HOME can be set to the path where gpsd can be found\&. (instead of adding that folder to the PATH envirnment variable
.SH "SEE ALSO"
.PP

\fBgpsd\fR(8),
\fBgps\fR(1),
\fBlibgps\fR(3),
\fBlibgpsd\fR(3),
\fBgpsctl\fR(1),
\fBgpspipe\fR(1),
\fBgpsprof\fR(1)
\fBgpsmon\fR(1)\&.
.SH "AUTHOR"
.PP
Eric S\&. Raymond
esr@thyrsus\&.com\&. There is a project page for
gpsd
\m[blue]\fBhere\fR\m[]\&\s-2\u[1]\d\s+2\&.
.SH "NOTES"
.IP " 1." 4
here
.RS 4
\%http://gpsd.berlios.de/
.RE
